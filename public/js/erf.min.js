
var ERFC_COF = [
  -2.8e-17, 1.21e-16, -9.4e-17, -1.523e-15, 7.106e-15,
   3.81e-16, -1.12708e-13, 3.13092e-13, 8.94487e-13,
  -6.886027e-12, 2.394038e-12, 9.6467911e-11,
  -2.27365122e-10, -9.91364156e-10, 5.059343495e-9,
   6.529054439e-9, -8.5238095915e-8, 1.5626441722e-8,
   1.303655835580e-6, -1.624290004647e-6,
  -2.0278578112534e-5, 4.2523324806907e-5,
   3.66839497852761e-4, -9.46595344482036e-4,
  -9.561514786808631e-3, 1.9476473204185836e-2,
   6.4196979235649026e-1, -1.3026537197817094
];
var ERFC_COF_LAST = ERFC_COF[ERFC_COF.length - 1];

function erfc(x) {
  function erfccheb(y) {
    var d = 0.0, dd = 0.0, temp = 0.0,
        t = 2.0 / (2.0 + y), ty = 4.0 * t - 2.0;
  
    for (var i = 0, l = ERFC_COF.length - 1; i < l; i++) {
      temp = d;
      d = ty * d - dd + ERFC_COF[i];
      dd = temp;
    }
  
    return t * Math.exp(-y * y + 0.5 * (ERFC_COF_LAST + ty * d) - dd);
  }
  
  return x >= 0.0 ? erfccheb(x) : 2.0 - erfccheb(-x);
}

function eloFn(eloDiff) {
  var formula = $("input[name=formula]:checked").val();
  return (formula == "normal") ?
         eloNormal(eloDiff) : eloLogistic(eloDiff);
}

function invEloFn(p) {
  var formula = $("input[name=formula]:checked").val();
  return (formula == "normal") ?
         invEloNormal(p) : invEloLogistic(p);
}

function bestOf3(p) {
  var q = 1-p;
  return p*p*(p + 3*q);
}

function bestOf5(p) {
  var q = 1-p;
  return p*p*p*(p*p + 5*p*q + 10*q*q);
}

function bestOf7(p) {
  var q = 1-p;
  return p*p*p*p*(p*p*p + 7*p*p*q + 21*p*q*q + 35*q*q*q);
}

function margin2(p) {
  var q = 1-p;
  return (p*p) / (p*p + q*q);
}

function margin3(p) {
  var q = 1-p;
  return (p*p*p) / (p*p*p + q*q*q);
}

function eloDiff(rating1, rating2){
  var diff = rating1 - rating2;
  var p = eloFn(diff);
  var p2 = inverseFn(womenMix, 0, 1, p);
  var diff2 = invEloFn(p2);
  return diff2;
}